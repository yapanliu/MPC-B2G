# MPC-B2G
Code for paper ["Model predictive control for building loads connected with a residential distribution grid"](https://doi.org/10.1016/j.apenergy.2018.08.051)

Aggregated control of electrical loads in a large cluster of buildings has been a challenge due to the complexity of the system involving generators, grid constraints, load serving entities complex load models, and people behavior. This paper introduces a novel load aggregation method in an electricity distribution system with Model Predictive Controlled (MPC) loads. This method closes the control loop from power generation to people behavior, resulting in a more stable and efficient integrated buildings-to-grid system. A behavior-driven price-based MPC is introduced for a residential building energy management system, which controls the air conditioner (AC), electric vehicle (EV), water heater, and battery energy storage system. A nodal pricing method is introduced representing power generation and distribution costs, which is mathematically proven to stabilize the system with MPC controlled loads. The method is tested in a 342-node residential building distribution network with 15,000 buildings which is inverse sampled from hundreds of actual smart meter data. The results show a 21% reduction in generation cost, 17% reduction in peak load, and reduced nodal voltage drop from the coordinated control system.